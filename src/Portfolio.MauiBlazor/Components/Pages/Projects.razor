@page "/projects"
@using Portfolio.Shared.Models
@using Portfolio.Shared.Components
@inject IApiService ApiService

<PageTitle>Projects - Bernard Lusale</PageTitle>

<div class="container my-4">
    <div class="row">
        <div class="col-12">
            <h1 class="display-4 text-primary mb-4">My Projects</h1>
            <p class="lead mb-5">A showcase of some of the projects I've worked on.</p>
        </div>
    </div>

    @if (projects != null && projects.Any())
    {
        <div class="row">
            @foreach (var project in projects)
            {
                <div class="col-md-6 col-lg-4 mb-4">
                    <ProjectCard Project="project" />
                </div>
            }
        </div>
    }
    else if (isLoading)
    {
        <div class="text-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Loading projects...</p>
        </div>
    }
    else
    {
        <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            No projects available at the moment.
        </div>
    }
</div>

@code {
    private List<Project>? projects;
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            projects = await ApiService.GetProjectsAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading projects: {ex.Message}");
            projects = new List<Project>();
        }
        finally
        {
            isLoading = false;
        }
    }
}