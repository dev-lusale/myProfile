@page "/about"
@inject IApiService ApiService
@inject IJSRuntime JSRuntime

<PageTitle>About - Bernard Lusale</PageTitle>

<div class="container my-4">
    <div class="row">
        <div class="col-12">
            <h1 class="display-4 text-primary mb-4">About Me</h1>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-4 mb-4">
            <img src="/images/dk.jpg" alt="Bernard Lusale" class="img-fluid rounded shadow" />
        </div>
        <div class="col-md-8">
            <div class="about-content">
                <h2 class="h3 mb-3">Computer Science Student & Cybersecurity Analyst</h2>
                <p class="lead">
                    I'm a Computer Science student at Copperbelt University and a Cybersecurity Analyst at Future Interns. 
                    My expertise combines cybersecurity analysis with modern web development, focusing on building secure, 
                    scalable applications. I specialize in security testing, vulnerability assessment, and developing 
                    robust web solutions using .NET technologies.
                </p>
                
                <h3 class="h4 mt-4 mb-3">What I Do</h3>
                <ul class="list-unstyled">
                    <li class="mb-2">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        Cybersecurity analysis and web application security testing
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        Penetration testing and vulnerability assessment
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        Full-stack web development with .NET and Blazor
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        Cross-platform development with .NET MAUI
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        Database design and SQL development
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        API development and security integration
                    </li>
                </ul>
                
                <h3 class="h4 mt-4 mb-3">My Approach</h3>
                <p>
                    I believe in building secure, maintainable applications with a security-first mindset. 
                    My approach combines rigorous security testing with modern development practices. 
                    I'm passionate about continuous learning in both cybersecurity and software development, 
                    staying current with emerging threats and cutting-edge technologies.
                </p>
            </div>
        </div>
    </div>

    <!-- Education Section -->
    <div class="row mt-5">
        <div class="col-12">
            <h2 class="h3 mb-4 text-primary">Education</h2>
            @if (education != null && education.Any())
            {
                @foreach (var edu in education)
                {
                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title text-primary">@edu.Degree</h5>
                            <h6 class="card-subtitle mb-2 text-muted">@edu.Institution, @edu.Location</h6>
                            <p class="card-text">
                                @if (edu.IsCompleted)
                                {
                                    <small class="text-success">Graduated: @edu.EndDate?.ToString("yyyy")</small>
                                }
                                else
                                {
                                    <small class="text-info">Expected Graduation: @edu.ExpectedGraduation</small>
                                }
                            </p>
                            @if (!string.IsNullOrEmpty(edu.Description))
                            {
                                <p class="card-text">@edu.Description</p>
                            }
                            @if (edu.Achievements != null && edu.Achievements.Any())
                            {
                                <div class="mt-3">
                                    <h6 class="text-success">Key Achievements:</h6>
                                    <ul class="list-unstyled">
                                        @foreach (var achievement in edu.Achievements)
                                        {
                                            <li class="mb-1">
                                                <i class="bi bi-check-circle text-success me-2"></i>@achievement
                                            </li>
                                        }
                                    </ul>
                                </div>
                            }
                        </div>
                    </div>
                }
            }
        </div>
    </div>

    <!-- Certifications Section -->
    <div class="row mt-4">
        <div class="col-12">
            <h2 class="h3 mb-4 text-primary">Certifications</h2>
            @if (certifications != null && certifications.Any())
            {
                <div class="row">
                    @foreach (var cert in certifications)
                    {
                        <div class="col-md-6 mb-3">
                            <div class="card h-100 shadow-sm border-start border-primary border-3">
                                <div class="card-body">
                                    <h6 class="card-title">@cert.Name</h6>
                                    <p class="card-text">
                                        <strong class="text-primary">@cert.IssuingOrganization</strong><br>
                                        <small class="text-muted">Issued: @cert.IssueDate.ToString("MMM yyyy")</small><br>
                                        @if (cert.ExpiryDate.HasValue)
                                        {
                                            <small class="text-muted">Expires: @cert.ExpiryDate.Value.ToString("MMM yyyy")</small><br>
                                        }
                                        @if (!string.IsNullOrEmpty(cert.CredentialId))
                                        {
                                            <small class="text-muted font-monospace">ID: @cert.CredentialId</small>
                                        }
                                    </p>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
        </div>
    </div>

    <!-- CV Download Section -->
    <div class="row mt-5">
        <div class="col-12 text-center">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h3 class="card-title text-primary">Download My CV</h3>
                    <p class="card-text">Get a comprehensive overview of my experience, skills, and achievements.</p>
                    <button class="btn btn-primary btn-lg" @onclick="DownloadCV">
                        <i class="bi bi-download me-2"></i>Download CV
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private List<Portfolio.Shared.Models.Education>? education;
    private List<Portfolio.Shared.Models.Certification>? certifications;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            education = await ApiService.GetEducationAsync();
            certifications = await ApiService.GetCertificationsAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading education/certifications: {ex.Message}");
            education = new List<Portfolio.Shared.Models.Education>();
            certifications = new List<Portfolio.Shared.Models.Certification>();
        }
    }

    private async Task DownloadCV()
    {
        // Create a download link and trigger the download
        var fileName = "Bernard_Lusale_CV.pdf";
        var fileUrl = "/documents/Bernard_Lusale_CV.pdf";
        
        await JSRuntime.InvokeVoidAsync("downloadFile", fileUrl, fileName);
    }
}